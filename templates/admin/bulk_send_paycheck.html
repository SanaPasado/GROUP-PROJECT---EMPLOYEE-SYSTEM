{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_modify %}

{% block title %}{{ title }} | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block extrahead %}
{{ block.super }}
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<style>
    body { font-family: 'Inter', sans-serif; }
    h1, h2 { font-weight: 700; }
    .form-row label { font-weight: 600; }
    .employee-checkbox { margin-bottom: 8px; }
    .select-all-btn { margin-bottom: 15px; }
</style>
{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
<a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
&rsaquo; <a href="{% url 'admin:accounts_employee_changelist' %}">Employees</a>
&rsaquo; Send Bulk Paycheck Notifications
</div>
{% endblock %}

{% block content %}
<div class="form-row">
    <h1 style="font-family: 'Inter', sans-serif; font-weight: 700;">{{ title }}</h1>

    <form method="post">
        {% csrf_token %}

        <fieldset class="module aligned">
            <h2 style="font-family: 'Inter', sans-serif; font-weight: 600;">Select Employees</h2>

            <div class="form-row">
                <button type="button" id="selectAll" class="button select-all-btn">
                    <i class="bi bi-check-all"></i> Select All
                </button>
                <button type="button" id="deselectAll" class="button select-all-btn">
                    <i class="bi bi-x-square"></i> Deselect All
                </button>
            </div>

            <div class="form-row">
                <div style="max-height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 10px;">
                    {% for employee in employees %}
                        <div class="employee-checkbox">
                            <label>
                                <input type="checkbox" name="employee_ids" value="{{ employee.id }}" class="employee-check">
                                <strong>{{ employee.get_full_name }}</strong>
                                ({{ employee.email }}) - {{ employee.department }}
                            </label>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </fieldset>

        <fieldset class="module aligned">
            <h2 style="font-family: 'Inter', sans-serif; font-weight: 600;">Notification Details</h2>

            <div class="form-row">
                <label for="notification_type" style="font-weight: 600;">Notification Type:</label>
                <select name="notification_type" id="notification_type" style="font-family: 'Inter', sans-serif;">
                    <option value="paycheck">Paycheck Sent</option>
                    <option value="bonus">Bonus Payment</option>
                    <option value="salary_adjustment">Salary Adjustment</option>
                </select>
            </div>

            <div class="form-row">
                <label for="amount" style="font-weight: 600;">Amount (Optional):</label>
                <input type="number" name="amount" id="amount" step="0.01" placeholder="0.00"
                       style="font-family: 'Inter', sans-serif;">
                <p class="help">Leave empty if you don't want to specify an amount</p>
            </div>

            <div class="form-row">
                <label for="message" style="font-weight: 600;">Custom Message:</label>
                <textarea name="message" id="message" rows="4" cols="40"
                          placeholder="Your paycheck has been sent!"
                          style="font-family: 'Inter', sans-serif;">Your paycheck has been sent!</textarea>
                <p class="help">This message will be displayed to the employees</p>
            </div>
        </fieldset>

        <div class="submit-row">
            <input type="submit" value="Send Notifications" class="default"
                   style="font-family: 'Inter', sans-serif; font-weight: 600;" />
            <a href="{% url 'admin:accounts_employee_changelist' %}" class="button cancel-link"
               style="font-family: 'Inter', sans-serif;">Cancel</a>
        </div>
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const selectAllBtn = document.getElementById('selectAll');
    const deselectAllBtn = document.getElementById('deselectAll');
    const checkboxes = document.querySelectorAll('.employee-check');

    selectAllBtn.addEventListener('click', function() {
        checkboxes.forEach(checkbox => {
            checkbox.checked = true;
        });
    });

    deselectAllBtn.addEventListener('click', function() {
        checkboxes.forEach(checkbox => {
            checkbox.checked = false;
        });
    });
});
</script>

<style>
    .cancel-link {
        margin-left: 10px;
        text-decoration: none;
        color: #666;
        font-family: 'Inter', sans-serif;
    }
    .help {
        font-size: 11px;
        color: #666;
        margin: 2px 0 0 0;
        font-family: 'Inter', sans-serif;
    }
</style>
{% endblock %}
